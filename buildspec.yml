version: 0.2

phases:
  install:
    runtime-versions:
      docker: 18
  pre_build:
    commands:
      - echo Logging in to Amazon ECR...
      - docker login -u AWS -p eyJwYXlsb2FkIjoiSUVJTXNOZ1U5OGRJMko1QnJwUDBmNlZUSHZ0Y0xWWUlEaGg0TksxWXZYSjYvVU9RNEh5VHNiSHJWUlpVRVU1QVJraEpiQm4zemM5UTYvby8wMGt3RlVFYkFTTk1lNkUvVmw0OVIyNlJZT1NGOU91Z3FQdVluSDRrdHMwaU5ObUxSOHE5QUFSVG81MC81SXNFTGpPc3AyTUtrajVtemlsRkFuK0lKeHpDeGFKWDl0V1l5Znk0VUNORlFWNlhXQmEzcDdYN1JZWUI4STR6QXFMR01RVWJTQ0NPMTdJa2RpaTZyeEszMXh1akJzNFIzKzl3UGRqUUtxWWFodEpOSFVGb0I0SkNrUVUwakY4aTlkOThNTW84dk9pbENFZ3BSRjEvQTVudVhJeXUzYU1oeVJaWE1IcEwvbmFVWGVGS29nZjZHYml2eGZuWHVUeEZFRGdYTnUwemNxNVVvQ2h6aGdNUVRhWXAwUGZmWThIbENsUlAyVVgrTnplSWp0S1RTdUlIS0ozK01KaEpjbGlYckUyTytPTTFTRzNaMXNaV25lVm5LeHdzdnQzUE9wOEtLZzFTTUoreGNZdjFQNmE0U0NFYWpHNDdaUWwrUWJPeUhlQ1hzd2hldEEyV1ZBU2wwcWVDWjBGcFRGKzFiWExxM0oxbnZuSm1oQlp2WDA0aGM0ZlUzY1IxTWxvN0FyTVNQL0V3Rk1iQkhHYU1nWnIxMlc2cjhUVTVwUWllQmtUNzBzQ2p0UmdOc1N5by9UYTQvMmx2Z1Nwa0EvTEt1S1lHZm9tZ2xuSVpPeGlLcWJnbGFkTitOVmVnYU1McDYvUWxPMlA4TEZUS3RhZ2ZwZXJ1dHEyMXRsdy81L3luSHY2NnpneG9wN0dmeWNUazhJaFlXZnVoNUxPYjlHTG83V3RLbDdQMURSQ1dkRkg1dFBCK1NOQ0lHS2F3aFJDR05QQzhGQXYzdk9EOTBteUYwbGtUMDFXUkhqUVpRSFJQYzRhNTM3YlNienU2cjBwa1RYQmR0Y3YwYU13ektiTGQxUWNSdCtJbHFYUnJXL096UVFRbHB2NnVaUFd1S0U0SjdMbDBkVmZnZjZvellyQ0dXQmpXc2VkZVJXMHE0SU1LNmtwNHMxUW1VUldmNlNxeTFJMktmalFQdlBPU2VqYXJjQUFFWUZkSHhwNGVuNUV2TTVBaG1iM1ZRN0ZXZkVSRnhpU3llclFvcU5PRWZrem9NdUhBZjU2b05VVGxURUJkRFgyM01HTDFmcCtQcWUwOFpGMWMrM1B1QSt1Y05uZzhqL2FqTTFqY0F4bEh2ZkNvYThDUUZuZmlTdG4wbGc1UXdYVzNEL1pqOVBSbnlsMzNPM2RrcVppM3hFTnk2b3pwcmJDTHpOcUZST1BMREZ0N0V5bU1SMkIyWkRvQW8zMkczSTArcmpCSlhRNGFtWERXUVZqdytiQVVoU2VTQTVyKyIsImRhdGFrZXkiOiJBUUVCQUhod20wWWFJU0plUnRKbTVuMUc2dXFlZWtYdW9YWFBlNVVGY2U5UnE4LzE0d0FBQUg0d2ZBWUpLb1pJaHZjTkFRY0dvRzh3YlFJQkFEQm9CZ2txaGtpRzl3MEJCd0V3SGdZSllJWklBV1VEQkFFdU1CRUVETUkrZ3JTb3ZwVGNVRnJPdndJQkVJQTdxZHM1dURzNkhZRDZRWloyVzYvUklobmtIV3lPTUdOdGIzV0FleDVJV3pZbXJwMjhLV1pqamdibE95NW1hWmVHSU9GTVA5WUJCSWU2VVY0PSIsInZlcnNpb24iOiIyIiwidHlwZSI6IkRBVEFfS0VZIiwiZXhwaXJhdGlvbiI6MTU2Njg4NDY3M30= https://223998089108.dkr.ecr.us-east-1.amazonaws.com
  build:
    commands:
      - echo Build started on `date`
      - echo Building the Docker image...          
      - docker build -t glcapstoneairpg .
      - docker tag glcapstoneairpg:latest 223998089108.dkr.ecr.us-east-1.amazonaws.com/glcapstoneairpg:latest     
  post_build:
    commands:
      - echo Build completed on `date`
      - echo Pushing the Docker image...
      - docker push 223998089108.dkr.ecr.us-east-1.amazonaws.com/glcapstoneairpg:latest