version: 0.2

phases:
  install:
    runtime-versions:
      docker: 18
  pre_build:
    commands:
      - echo Logging in to Amazon ECR...
      - docker login -u AWS -p eyJwYXlsb2FkIjoiQ3NRd0ViK3RBNnRxQkdlczhORHlLYktiRDlPMlh5Mlo0d2FUNm05MVhRamNPMkp0Y2M2a0tZNDZTbzZLV1dVMUdjOW93d3UxNzllWDBQbUVlakRpSThXbFMwREVwZjRlRWtGNnFyQ3AzM0FnSHlJcmp1ZXNuVklUSnlINWllYkNOaExtb1VXaHc5NVQwTzFTRWE0R0hrV1dlWHE5Rzl4Wld1aXpZZGtHZW1BclVaZUg3RjJwT3VoSEttOTZONkUrdy84cW5ZMURwQ01QSjZOajVndlpCZlZvR0pzUUMzOGd1RDkzYnY0ZGQwZS8xQUgyUTh6M2lQSC9sdG9FK1pxeXJjU09ZT3pFL1I5VDdwSjd1bHZCVlVYVVNnMUdpZlpVby9PeXFWSlhpZkJwUytlbzJFNTlGZ0hZM3NoTGVOUld5NGw2TVo3YzdtOE1udXloMzhPMis5T3BYQWJOMlRrWnNFd1Z5MGhXNjVRTzNnRnlnVWZiSVBwUlNZMWhkbDcrcThMajErWWhPVHpLQUxZYnZTNWsvL3ZZRGVycER5MVRGMFNzekdLWjM1aDk0RC9uS3BOMzNwOU9nNHRQYk50RUVrUTdLN1lzdmZaTXozYko2SEk0R2FwVSs1eld0NG5KSlVRUWFaTnhwVkZuZHZOWVFZN2R5RGlmbFN1L3BqTlNIUVBUMTNsMlA5N2VuN1hlL0pRY0xNRDJJUXNmbVY3cndWSVQ4QWplUXhSd25FT042Qmt6S2dadCs5WVRaclA5T3BBTHhOZmZJNkowRE9nY1EvNzJhSCtuVENYYWREaDFybHRCYTdPZmd1ZkcrMFRRQVhOU0pFZVpIaGhnMVRPSXlFTFB0VGUxUDIxNk1TVFo1M202Z3B2T0RwTzRtb3BQTjE5QVlmeHEzV05Bb1ROQ2pjcDBidkRYS2gvS1ZhdjNEZTAzY3JvV0FWelY2U25XVEs4ZW1PMmJKWVZjcG14aCs2QXZ2TzNTaWZWdkdHZmpjV3hHaS9NUE0zZEtXTnRLdmZkdkxqenFFN09UN3V6MmJIbDF5bUVreFBaWnk5bEhkZzZodU5XYys0TktyeTFZUU84SFFmc0poM2ZvS2VmcnhzY1NxRGpZbDFoT002UFBrMXJzeGxuaHVxS1ZkUlRaWkNQT0JIL2FiTWZRSFFkY2w4V1JCbTVHL1RsYUtFSUZqY05zWVpSbjJ6YWpaSXpDR2xNajBUUlRFRjJUb1NMdmRqMTVmMmxtYnYwSisxMVp6ak03SVp2QnVyOG52NjBkRDBlVzRuaWpKQVdjeGpzQzJPUnlIYWIzSUtueEhaRmJKcjhxL0NFMXZFTFl3Q3YzU3o4TzdxMTlXZHgwRkovNnBHOXRHamN5SjFDNXNtT1FsNlpNQjJKa3AzQ0dxY2pjc29MSHd6Q3A5OGJXanBNMGJxQ2ljQjVtSGFXb0lDZmdXYW1QYmFXciIsImRhdGFrZXkiOiJBUUVCQUhod20wWWFJU0plUnRKbTVuMUc2dXFlZWtYdW9YWFBlNVVGY2U5UnE4LzE0d0FBQUg0d2ZBWUpLb1pJaHZjTkFRY0dvRzh3YlFJQkFEQm9CZ2txaGtpRzl3MEJCd0V3SGdZSllJWklBV1VEQkFFdU1CRUVESXF6czVHaFR1S0NGTTcvUXdJQkVJQTdZb2paL1kxdEFLTVlBM2RBdTZSbEV1R1djenFpQkNCcDlYb0dwMkZuck9WK3MxZFRCVmdCVlNwRHV1UE1aNERyRThvWi9nZzR6L3RhZWtVPSIsInZlcnNpb24iOiIyIiwidHlwZSI6IkRBVEFfS0VZIiwiZXhwaXJhdGlvbiI6MTU2Njk3NDY2OH0= https://223998089108.dkr.ecr.us-east-1.amazonaws.com
  build:
    commands:
      - echo Build started on `date`
      - echo Building the Docker image...          
      - docker build -t glcapstoneairpg .
      - docker tag glcapstoneairpg:latest 223998089108.dkr.ecr.us-east-1.amazonaws.com/glcapstoneairpg:latest     
  post_build:
    commands:
      - echo Build completed on `date`
      - echo Pushing the Docker image...
      - docker push 223998089108.dkr.ecr.us-east-1.amazonaws.com/glcapstoneairpg:latest