version: 0.2

phases:
  install:
    runtime-versions:
      docker: 18
  pre_build:
    commands:
      - echo Logging in to Amazon ECR...
      - docker login -u AWS -p eyJwYXlsb2FkIjoiYllteVNUSEgwZEZkSXdmWTRQd3pkdzUvc1ppSTZEQThEZGZqbVBLOWtKZE9BSStILzE0czdyYXVaNnoyQnFkSFkwTlZMNThKYTA1RURaOWJkRkZValp5OVVyY05oOFlpTlhtY0F4d0UzVHIzU0VCeVRrMHM1ODlwVGR2aTFSQ3EvUU9zWTBJcXAzZDlxWnRraUFkM3p4eTA3amh0MG1Uc25iQ0F1MDFZTzFQdmdXaVkxWW1Md0RQTjNWVmx4UThTNnFQN2VaQWFocDlJTkxYeE5aZHZZYzYvcmVGN1FnVjhUZVpHbHFwcWpUL3JXOVY3Y1gwVDNBTGR5MERyUE1Ja3QxZHJyUmF3cmdTSmhQUm8yUVYrZnpsZEJySngwZnRyUmgxdGtnYkpyTzZwTmpZTmpZczBjZVZsMTZHQWF2eFVtVm1wQmlnTkIwNlRSczNGUXBSSFZpZHk1dHBSbkNJRGhYZmcxYmtTcDA1eWM0QVBmblJQaXRWekRIaFFRdVpTVHNsUDZldlJaZTNuU0UzMFZlblJ0U0FCRys1RHE1SGxzMU1hcUxnWlZNUVdaT2Zzd3ZWV2pidFRnN1luZ0trb2U4K1ltRUtrOTZaQVl5cTVPY2dQek9qL2hJSVBMRHhpNnBhN0lZclluWW0yanltRkwyOEFraHdJZmhrc1Y2ZmFQSWFSQzZwdm0rZmpla2ZpUmhydW9WMkdXOSs4R292a3JNSTFzNjdWcElnQUhUSkF2a0dMYWhvL0pJL1lvU3JXemxOcDJOOWNFMHBsRXJPV04xTHNRY3grWDhCSjlLU2dJcWVMaENTNDl6empSRzhPczhHazZlTjRnK0UrYUFoMXdvOHc1NU9mU3RxNUFVSy9qaTNpc2ZJSUVHZTMyMWFzQm44VXJxZEt1TlFuOENuV3kyRmQ5aXdhSkZOUUVMbms2YWxMWXM3bEJQVmFJK2t5M1Q1Z2NsbnhIZ2FRNGJCcks1eUpRd212T0xIMzUrWjFHRTFyWW01ZUVGTmhYQkdhb3JSNnJZV3JUWGpYb3ZVV1Jmd3N1NTg5Zno3MXU0N0t5UjZtZGd3Slk3c05ualZtYmUzUXRhMmpJcld1V25lV1loSkcvUkhFSGV4d2lKQXhYYjh0MEZnTUQvWEgyeDJGVnFGNDg4c1FDRnRMYXdvQXZWallQSEZHRHFvZ0ZvRmp1SnMwOXRMeDFGRmRxOENSK1ArdU9SckNLOWdIMUJzV2ttTXFINUY0YU16NG5rWXBhejFyOTlIc0toVGU4UXY2VHQvV3krVFIvN1hjVGkxOGdqUEd4UVZIbVJnNEhjUVhHNCsrWHVzVGoyUmFseTBrYXdTdHpveFJwcTVWUTIwL1pNdmowVEJUWkFJQkR5M0xaYktmK1pMMTdhU0ZUdzRtYWhoQ2tUdmIyRWdSaUNkRm42d2oxWWFiK0FIeXRtSVAwMThHeHgxYyIsImRhdGFrZXkiOiJBUUVCQUhod20wWWFJU0plUnRKbTVuMUc2dXFlZWtYdW9YWFBlNVVGY2U5UnE4LzE0d0FBQUg0d2ZBWUpLb1pJaHZjTkFRY0dvRzh3YlFJQkFEQm9CZ2txaGtpRzl3MEJCd0V3SGdZSllJWklBV1VEQkFFdU1CRUVESEdnVE5MRWVCODFVYTcxekFJQkVJQTdNdjNuZzdsejV3RkdISnRCdXd5ZVNVUUc5dlNkbkxCMDNEMGJHalhTbG9LQVZQMDJWTnMwMDM3WkFHSjQ4REk3TFQ0ZElLVkhFK3hGc1E4PSIsInZlcnNpb24iOiIyIiwidHlwZSI6IkRBVEFfS0VZIiwiZXhwaXJhdGlvbiI6MTU2Njc2OTI3M30= https://223998089108.dkr.ecr.us-east-1.amazonaws.com
  build:
    commands:
      - echo Build started on `date`
      - echo Building the Docker image...          
      - docker build -t glcapstoneairpg .
      - docker tag glcapstoneairpg:latest 223998089108.dkr.ecr.us-east-1.amazonaws.com/glcapstoneairpg:latest     
  post_build:
    commands:
      - echo Build completed on `date`
      - echo Pushing the Docker image...
      - docker push 223998089108.dkr.ecr.us-east-1.amazonaws.com/glcapstoneairpg:latest